(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{55760:function(e,t,r){Promise.resolve().then(r.bind(r,37275))},37275:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return eN}});var a=r(57437),s=r(14811),o=r.n(s),l=r(48667);r(2778);var n=r(67506),i=r(46550),d=r(53690),c=r(69427);i.ZP.use(d.Z).use(c.Z).use(n.Db).init({supportedLngs:["en","hi"],fallbackLng:"en",ns:["common","translation","phq9","gad7","suggestions","dashboard","appointments","resources","exercises","forum"],defaultNS:"common",interpolation:{escapeValue:!1},debug:!0,detection:{order:["cookie","localStorage","navigator","htmlTag"],caches:["cookie","localStorage"]},backend:{loadPath:"/locales/{{lng}}/{{ns}}.json"}});var u=i.ZP,m=r(2265),f=e=>{let{children:t}=e;return(0,m.useEffect)(()=>{let e=e=>{document.documentElement.lang=e};return u.on("languageChanged",e),e(u.language),()=>{u.off("languageChanged",e)}},[]),(0,a.jsx)(n.a3,{i18n:u,children:t})};let p=(0,m.createContext)(void 0),x=e=>{let{children:t}=e,[r,s]=(0,m.useState)(null),[o,l]=(0,m.useState)(null);return(0,a.jsx)(p.Provider,{value:{moodResult:r,setMoodResult:s,screeningResult:o,setScreeningResult:l},children:t})},h=()=>{let e=(0,m.useContext)(p);if(void 0===e)throw Error("useMood must be used within a MoodProvider");return e};var g=r(40477),v=r(58086);let b=()=>{let{results:e}=(0,g.a)(),{moodResult:t}=h();return(0,m.useEffect)(()=>{if(e.length>0){var t,r;let a=e[e.length-1];(null===(r=window.voiceflow)||void 0===r?void 0:null===(t=r.chat)||void 0===t?void 0:t.setVariables)&&(console.log("Updating Voiceflow with test result:",a),window.voiceflow.chat.setVariables({lastTestType:a.testType,lastTestScore:a.score,lastTestSeverity:a.severity}))}},[e]),(0,m.useEffect)(()=>{if(t){var e,r;(null===(r=window.voiceflow)||void 0===r?void 0:null===(e=r.chat)||void 0===e?void 0:e.setVariables)&&(console.log("Updating Voiceflow with mood result:",t),window.voiceflow.chat.setVariables({dominantMood:t.dominantMood,depressionScore:t.depression,anxietyScore:t.anxiety}))}},[t]),null};var y=r(27648);let j=()=>(0,a.jsxs)(y.default,{href:"/",className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"w-8 h-8 rounded-full bg-purple-600 flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white font-semibold",children:"M"})}),(0,a.jsx)("span",{className:"text-xl font-semibold text-white",children:"MindCare"})]});var N=()=>{let{i18n:e}=(0,n.$G)(),[t,r]=(0,m.useState)(!1);return((0,m.useEffect)(()=>{r(!0)},[]),t)?(0,a.jsx)("div",{className:"flex items-center space-x-2",children:[{code:"en",name:"English"},{code:"hi",name:"हिंदी"}].map(t=>(0,a.jsx)("button",{onClick:()=>e.changeLanguage(t.code),disabled:e.language===t.code,className:"px-3 py-1 rounded-md text-sm font-medium transition-colors \n            ".concat(e.language===t.code?"bg-purple-600 text-white cursor-default":"bg-gray-700 text-gray-300 hover:bg-gray-600"),children:t.name},t.code))}):null},w=r(12381),k=r(39537),S=r(32489),I=r(93448);let C=k.fC;k.xz;let _=k.h_;k.x8;let R=m.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(k.aV,{ref:t,className:(0,I.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...s})});R.displayName=k.aV.displayName;let z=m.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsxs)(_,{children:[(0,a.jsx)(R,{}),(0,a.jsxs)(k.VY,{ref:t,className:(0,I.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...o,children:[s,(0,a.jsxs)(k.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});z.displayName=k.VY.displayName;let F=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,I.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};F.displayName="DialogHeader";let P=m.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(k.Dx,{ref:t,className:(0,I.cn)("text-lg font-semibold leading-none tracking-tight",r),...s})});P.displayName=k.Dx.displayName;let E=m.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(k.dk,{ref:t,className:(0,I.cn)("text-sm text-muted-foreground",r),...s})});E.displayName=k.dk.displayName;var Z=r(45701),O=r(29501),U=r(67119),T=r(41671),J=r(86595),W=r(51817),V=r(80670),Y=r(23675);let A=U.Ry({rating:U.Rx().min(1,{message:"Please provide a rating."}),mostHelpful:U.Z_().optional(),improvement:U.Z_().max(1e3).optional(),recommend:U.Km(["yes","no","maybe"],{required_error:"Please select an option."})}),G=["AI Chat","Forum","Resources","Appointments","Other"];function M(e){let{setOpen:t}=e,[r,s]=(0,m.useState)(!1),[o,l]=(0,m.useTransition)(),{profile:n}=(0,v.G)(),i=(0,O.cI)({resolver:(0,Z.F)(A),defaultValues:{rating:0,mostHelpful:"",improvement:"",recommend:void 0}});async function d(e){l(async()=>{try{var t,r;let a=localStorage.getItem("userId")||(null==n?void 0:n.id)||"anonymous-user",o=localStorage.getItem("userEmail")||(null==n?void 0:n.email)||"anonymous@example.com",l=(null===(t=localStorage.getItem("userName"))||void 0===t?void 0:t.trim())||(null==n?void 0:null===(r=n.full_name)||void 0===r?void 0:r.trim())||null,i=l||o.split("@")[0]||"Anonymous User";console.log("Feedback submission - User data:",{userId:a,userEmail:o,userName:l,displayName:i,profileData:n}),console.log("Submitting feedback:",e),console.log("User info:",{userId:a,userEmail:o,userName:l,displayName:i}),console.log("Profile data:",n);let d={userId:a,userEmail:o,userName:i,feedback_text:"Rating: ".concat(e.rating,"/5 stars\nMost Helpful Feature: ").concat(e.mostHelpful||"Not specified","\nImprovement Suggestions: ").concat(e.improvement||"None provided","\nWould Recommend: ").concat(e.recommend,"\nSubmitted by: ").concat(i),rating:e.rating,mostHelpful:e.mostHelpful,improvement:e.improvement,recommend:e.recommend},c=await fetch("http://127.0.0.1:5001/api/feedback",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d)});if(console.log("Feedback API response status:",c.status),c.ok){let e=await c.json();console.log("Feedback submitted successfully:",e),s(!0)}else{let e=await c.text();console.error("Failed to submit feedback:",e),alert("Failed to submit feedback. Please try again.")}}catch(e){console.error("An error occurred:",e),alert("Network error. Please check your connection and try again.")}})}return r?(0,a.jsxs)("div",{className:"flex flex-col items-center justify-center text-center p-8 space-y-4",children:[(0,a.jsx)(T.Z,{className:"h-16 w-16 text-green-500"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-foreground",children:"Thank You!"}),(0,a.jsx)("p",{className:"text-muted-foreground mt-1",children:"Your feedback has been submitted successfully."})]}),(0,a.jsx)(w.z,{onClick:()=>t(!1),className:"bg-purple-600 hover:bg-purple-700",children:"Close"})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)(F,{children:[(0,a.jsx)(P,{className:"text-2xl",children:"Share Your Feedback"}),(0,a.jsx)(E,{children:"Your insights help us improve CalmNest for everyone."})]}),(0,a.jsx)(V.l0,{...i,children:(0,a.jsxs)("form",{onSubmit:i.handleSubmit(d),className:"space-y-6 mt-4",children:[(0,a.jsx)(V.Wi,{control:i.control,name:"rating",render:e=>{let{field:t}=e;return(0,a.jsxs)(V.xJ,{children:[(0,a.jsx)(V.lX,{className:"text-foreground",children:"How would you rate your overall experience?"}),(0,a.jsx)(V.NI,{children:(0,a.jsx)("div",{className:"flex items-center space-x-1",children:[1,2,3,4,5].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>t.onChange(e),className:"focus:outline-none focus:ring-2 focus:ring-purple-500 rounded",children:(0,a.jsx)(J.Z,{className:"h-8 w-8 cursor-pointer transition-all duration-200 hover:scale-110 ".concat(e<=t.value?"text-yellow-400 fill-yellow-400":"text-gray-400 hover:text-yellow-300")})},e))})}),(0,a.jsx)(V.zG,{})]})}}),(0,a.jsx)(V.Wi,{control:i.control,name:"mostHelpful",render:e=>{let{field:t}=e;return(0,a.jsxs)(V.xJ,{children:[(0,a.jsx)(V.lX,{className:"text-foreground",children:"Which feature did you find most helpful?"}),(0,a.jsx)(V.NI,{children:(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:G.map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>t.onChange(e),className:"p-3 rounded-lg border-2 transition-all duration-200 text-left ".concat(t.value===e?"border-purple-500 bg-purple-500/20 text-purple-300":"border-border bg-card text-foreground hover:border-purple-400 hover:bg-purple-500/10"),children:e},e))})}),(0,a.jsx)(V.zG,{})]})}}),(0,a.jsx)(V.Wi,{control:i.control,name:"improvement",render:e=>{let{field:t}=e;return(0,a.jsxs)(V.xJ,{children:[(0,a.jsx)(V.lX,{className:"text-foreground",children:"How can we improve your experience?"}),(0,a.jsx)(V.NI,{children:(0,a.jsx)(Y.g,{placeholder:"Any suggestions or ideas are welcome!",className:"bg-input border-border text-foreground min-h-[100px]",...t})}),(0,a.jsx)(V.zG,{})]})}}),(0,a.jsx)(V.Wi,{control:i.control,name:"recommend",render:e=>{let{field:t}=e;return(0,a.jsxs)(V.xJ,{children:[(0,a.jsx)(V.lX,{className:"text-foreground",children:"Would you recommend CalmNest to a friend?"}),(0,a.jsx)(V.NI,{children:(0,a.jsx)("div",{className:"flex gap-4",children:[{value:"yes",label:"Yes"},{value:"no",label:"No"},{value:"maybe",label:"Maybe"}].map(e=>(0,a.jsx)("button",{type:"button",onClick:()=>t.onChange(e.value),className:"flex-1 p-3 rounded-lg border-2 transition-all duration-200 ".concat(t.value===e.value?"border-purple-500 bg-purple-500/20 text-purple-300":"border-border bg-card text-foreground hover:border-purple-400 hover:bg-purple-500/10"),children:e.label},e.value))})}),(0,a.jsx)(V.zG,{})]})}}),(0,a.jsxs)(w.z,{type:"submit",disabled:o,className:"w-full bg-purple-600 hover:bg-purple-700",children:[o&&(0,a.jsx)(W.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Submit Feedback"]})]})})]})}function D(e){let{children:t}=e,[r,s]=(0,m.useState)(!1),o=(0,m.cloneElement)(t,{onClick:()=>s(!0)});return(0,a.jsxs)(a.Fragment,{children:[o,(0,a.jsx)(C,{open:r,onOpenChange:s,children:(0,a.jsx)(z,{className:"bg-background text-foreground border-border max-w-2xl",children:(0,a.jsx)(M,{setOpen:s})})})]})}var H=r(78298),X=r(71774),L=r(99376),Q=r(70085),q=r(10407),B=r(30401),$=r(40519);let K=Q.fC,ee=Q.xz;Q.ZA;let et=Q.Uv,er=Q.Tr;Q.Ee;let ea=m.forwardRef((e,t)=>{let{className:r,inset:s,children:o,...l}=e;return(0,a.jsxs)(Q.fF,{ref:t,className:(0,I.cn)("flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s&&"pl-8",r),...l,children:[o,(0,a.jsx)(q.Z,{className:"ml-auto"})]})});ea.displayName=Q.fF.displayName;let es=m.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(Q.tu,{ref:t,className:(0,I.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",r),...s})});es.displayName=Q.tu.displayName;let eo=m.forwardRef((e,t)=>{let{className:r,sideOffset:s=4,...o}=e;return(0,a.jsx)(Q.Uv,{children:(0,a.jsx)(Q.VY,{ref:t,sideOffset:s,className:(0,I.cn)("z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]",r),...o})})});eo.displayName=Q.VY.displayName;let el=m.forwardRef((e,t)=>{let{className:r,inset:s,...o}=e;return(0,a.jsx)(Q.ck,{ref:t,className:(0,I.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",s&&"pl-8",r),...o})});el.displayName=Q.ck.displayName,m.forwardRef((e,t)=>{let{className:r,children:s,checked:o,...l}=e;return(0,a.jsxs)(Q.oC,{ref:t,className:(0,I.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),checked:o,...l,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(Q.wU,{children:(0,a.jsx)(B.Z,{className:"h-4 w-4"})})}),s]})}).displayName=Q.oC.displayName,m.forwardRef((e,t)=>{let{className:r,children:s,...o}=e;return(0,a.jsxs)(Q.Rk,{ref:t,className:(0,I.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...o,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(Q.wU,{children:(0,a.jsx)($.Z,{className:"h-2 w-2 fill-current"})})}),s]})}).displayName=Q.Rk.displayName;let en=m.forwardRef((e,t)=>{let{className:r,inset:s,...o}=e;return(0,a.jsx)(Q.__,{ref:t,className:(0,I.cn)("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",r),...o})});en.displayName=Q.__.displayName;let ei=m.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(Q.Z0,{ref:t,className:(0,I.cn)("-mx-1 my-1 h-px bg-muted",r),...s})});ei.displayName=Q.Z0.displayName;var ed=r(61146);let ec=m.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(ed.fC,{ref:t,className:(0,I.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",r),...s})});ec.displayName=ed.fC.displayName,m.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(ed.Ee,{ref:t,className:(0,I.cn)("aspect-square h-full w-full",r),...s})}).displayName=ed.Ee.displayName;let eu=m.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(ed.NY,{ref:t,className:(0,I.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",r),...s})});eu.displayName=ed.NY.displayName;var em=r(92369),ef=r(85929),ep=r(97226),ex=r(57716),eh=r(47692),eg=r(18930);function ev(){var e,t;let{setTheme:r}=(0,H.F)(),s=(0,X.useSession)(),o=(0,X.useSupabaseClient)(),l=(0,L.useRouter)(),{profile:n,loading:i}=(0,v.G)(),d=async()=>{await o.auth.signOut(),l.refresh()},c=async()=>{window.confirm("Are you sure you want to delete your account? This action is irreversible.")&&alert("Account deletion is not yet implemented.")};return s?(0,a.jsxs)(K,{children:[(0,a.jsx)(ee,{asChild:!0,children:(0,a.jsx)(w.z,{variant:"ghost",className:"relative h-8 w-8 rounded-full",children:(0,a.jsx)(ec,{className:"h-8 w-8",children:(0,a.jsx)(eu,{className:"bg-purple-600 text-white",children:((e,t)=>{if(e&&e.trim()){let t=e.trim().split(" ");return t.length>=2?(t[0].charAt(0)+t[t.length-1].charAt(0)).toUpperCase():t[0].charAt(0).toUpperCase()}return t?t.charAt(0).toUpperCase():"?"})(null==n?void 0:n.full_name,s.user.email||"")})})})}),(0,a.jsxs)(eo,{className:"w-56",align:"end",forceMount:!0,children:[(0,a.jsx)(en,{className:"font-normal",children:(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsx)("p",{className:"text-sm font-medium leading-none",children:(null==n?void 0:n.full_name)&&n.full_name.trim()?n.full_name:(null==s?void 0:null===(t=s.user)||void 0===t?void 0:null===(e=t.email)||void 0===e?void 0:e.split("@")[0])||"User"}),(0,a.jsx)("p",{className:"text-xs leading-none text-muted-foreground",children:s.user.email})]})}),(0,a.jsx)(ei,{}),(0,a.jsx)(el,{asChild:!0,children:(0,a.jsxs)(y.default,{href:"/profile",children:[(0,a.jsx)(em.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Profile"})]})}),(0,a.jsxs)(er,{children:[(0,a.jsxs)(ea,{children:[(0,a.jsx)(ef.Z,{className:"h-[1.2rem] w-[1.2rem] rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0 mr-2"}),(0,a.jsx)(ep.Z,{className:"absolute h-[1.2rem] w-[1.2rem] rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100 mr-2"}),(0,a.jsx)("span",{children:"Theme"})]}),(0,a.jsx)(et,{children:(0,a.jsxs)(es,{children:[(0,a.jsxs)(el,{onClick:()=>r("light"),children:[(0,a.jsx)(ef.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Light"})]}),(0,a.jsxs)(el,{onClick:()=>r("dark"),children:[(0,a.jsx)(ep.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Dark"})]}),(0,a.jsxs)(el,{onClick:()=>r("system"),children:[(0,a.jsx)(ex.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"System"})]})]})})]}),(0,a.jsx)(ei,{}),(0,a.jsxs)(el,{onClick:d,children:[(0,a.jsx)(eh.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Log out"})]}),(0,a.jsxs)(el,{onClick:c,className:"text-red-500 focus:text-red-500 focus:bg-red-500/10",children:[(0,a.jsx)(eg.Z,{className:"mr-2 h-4 w-4"}),(0,a.jsx)("span",{children:"Delete Account"})]})]})]}):(0,a.jsx)(w.z,{asChild:!0,variant:"outline",size:"sm",className:"border-purple-600 text-purple-400 hover:bg-purple-600 hover:text-white",children:(0,a.jsx)(y.default,{href:"/login",children:"Login"})})}let eb=()=>{let{t:e}=(0,n.$G)(),[t,r]=(0,m.useState)(!1),s=(0,L.usePathname)();return(0,m.useEffect)(()=>{r(!0)},[]),(0,a.jsx)("header",{className:"fixed w-full z-50 bg-background/80 backdrop-blur-sm",children:(0,a.jsxs)("nav",{className:"container-custom py-4 flex items-center justify-between",children:[(0,a.jsx)(j,{}),t&&(0,a.jsxs)("div",{className:"hidden md:flex items-center space-x-4 text-sm",children:[(0,a.jsx)(y.default,{href:"/dashboard",className:"".concat(s.startsWith("/dashboard")?"text-primary":"text-muted-foreground"," hover:text-primary transition-colors"),children:e("nav.dashboard")}),(0,a.jsx)(y.default,{href:"/self-check",className:"".concat(s.startsWith("/self-check")?"text-primary":"text-muted-foreground"," hover:text-primary transition-colors"),children:e("nav.selfCheck")}),(0,a.jsx)(y.default,{href:"/appointments",className:"".concat(s.startsWith("/appointments")?"text-primary":"text-muted-foreground"," hover:text-primary transition-colors"),children:e("nav.appointments")}),(0,a.jsx)(y.default,{href:"/resources",className:"".concat(s.startsWith("/resources")?"text-primary":"text-muted-foreground"," hover:text-primary transition-colors"),children:e("nav.resources")}),(0,a.jsx)(y.default,{href:"/forum",className:"".concat(s.startsWith("/forum")?"text-primary":"text-muted-foreground"," hover:text-primary transition-colors"),children:e("nav.forum")}),(0,a.jsx)(y.default,{href:"/exercises",className:"".concat(s.startsWith("/exercises")?"text-primary":"text-muted-foreground"," hover:text-primary transition-colors"),children:e("nav.exercises")}),(0,a.jsx)(y.default,{href:"/music-therapy",className:"".concat(s.startsWith("/music-therapy")?"text-primary":"text-muted-foreground"," hover:text-primary transition-colors"),children:e("nav.musicTherapy")}),(0,a.jsx)(y.default,{href:"/mood-groove",className:"".concat(s.startsWith("/mood-groove")?"text-primary":"text-muted-foreground"," hover:text-primary transition-colors"),children:e("nav.moodGroove")}),(0,a.jsx)(D,{children:(0,a.jsx)(w.z,{variant:"ghost",className:"text-muted-foreground hover:text-primary transition-colors",children:e("nav.feedback")})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(N,{}),t&&(0,a.jsx)(ev,{})]})]})})};var ey=r(88933);function ej(e){let{children:t,...r}=e;return(0,a.jsx)(H.f,{...r,children:t})}function eN(e){let{children:t}=e;return(0,a.jsx)("html",{lang:"en",suppressHydrationWarning:!0,children:(0,a.jsxs)("body",{className:"".concat(o().className," bg-white dark:bg-gray-900 text-gray-900 dark:text-gray-100"),children:[(0,a.jsx)(ej,{attribute:"class",defaultTheme:"system",enableSystem:!0,disableTransitionOnChange:!0,children:(0,a.jsx)(X.SessionContextProvider,{supabaseClient:ey.O,children:(0,a.jsx)(v.X,{children:(0,a.jsx)(f,{children:(0,a.jsx)(x,{children:(0,a.jsxs)(g.G,{children:[(0,a.jsx)(b,{}),(0,a.jsx)(eb,{}),(0,a.jsx)("main",{className:"pt-20",children:t})]})})})})})}),(0,a.jsx)(l.default,{strategy:"lazyOnload",onLoad:()=>{window.voiceflow&&window.voiceflow.chat.load({verify:{projectID:"68f116283303c3139e725906"},url:"https://general-runtime.voiceflow.com",versionID:"production"})},src:"https://cdn.voiceflow.com/widget-next/bundle.mjs"})]})})}},12381:function(e,t,r){"use strict";r.d(t,{d:function(){return i},z:function(){return d}});var a=r(57437),s=r(2265),o=r(37053),l=r(90535),n=r(93448);let i=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=s.forwardRef((e,t)=>{let{className:r,variant:s,size:l,asChild:d=!1,...c}=e,u=d?o.g7:"button";return(0,a.jsx)(u,{className:(0,n.cn)(i({variant:s,size:l,className:r})),ref:t,...c})});d.displayName="Button"},80670:function(e,t,r){"use strict";r.d(t,{NI:function(){return h},Wi:function(){return u},l0:function(){return d},lX:function(){return x},xJ:function(){return p},zG:function(){return g}});var a=r(57437),s=r(2265),o=r(37053),l=r(29501),n=r(93448),i=r(75060);let d=l.RV,c=s.createContext(null),u=e=>{let{...t}=e;return(0,a.jsx)(c.Provider,{value:{name:t.name},children:(0,a.jsx)(l.Qr,{...t})})},m=()=>{let e=s.useContext(c),t=s.useContext(f),{getFieldState:r,formState:a}=(0,l.Gc)();if(!e)throw Error("useFormField should be used within <FormField>");if(!t)throw Error("useFormField should be used within <FormItem>");let o=r(e.name,a),{id:n}=t;return{id:n,name:e.name,formItemId:"".concat(n,"-form-item"),formDescriptionId:"".concat(n,"-form-item-description"),formMessageId:"".concat(n,"-form-item-message"),...o}},f=s.createContext(null),p=s.forwardRef((e,t)=>{let{className:r,...o}=e,l=s.useId();return(0,a.jsx)(f.Provider,{value:{id:l},children:(0,a.jsx)("div",{ref:t,className:(0,n.cn)("space-y-2",r),...o})})});p.displayName="FormItem";let x=s.forwardRef((e,t)=>{let{className:r,...s}=e,{error:o,formItemId:l}=m();return(0,a.jsx)(i._,{ref:t,className:(0,n.cn)(o&&"text-destructive",r),htmlFor:l,...s})});x.displayName="FormLabel";let h=s.forwardRef((e,t)=>{let{...r}=e,{error:s,formItemId:l,formDescriptionId:n,formMessageId:i}=m();return(0,a.jsx)(o.g7,{ref:t,id:l,"aria-describedby":s?"".concat(n," ").concat(i):"".concat(n),"aria-invalid":!!s,...r})});h.displayName="FormControl",s.forwardRef((e,t)=>{let{className:r,...s}=e,{formDescriptionId:o}=m();return(0,a.jsx)("p",{ref:t,id:o,className:(0,n.cn)("text-[0.8rem] text-muted-foreground",r),...s})}).displayName="FormDescription";let g=s.forwardRef((e,t)=>{var r;let{className:s,children:o,...l}=e,{error:i,formMessageId:d}=m(),c=i?String(null!==(r=null==i?void 0:i.message)&&void 0!==r?r:""):o;return c?(0,a.jsx)("p",{ref:t,id:d,className:(0,n.cn)("text-[0.8rem] font-medium text-destructive",s),...l,children:c}):null});g.displayName="FormMessage"},75060:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var a=r(57437),s=r(2265),o=r(6394),l=r(90535),n=r(93448);let i=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(o.f,{ref:t,className:(0,n.cn)(i(),r),...s})});d.displayName=o.f.displayName},23675:function(e,t,r){"use strict";r.d(t,{g:function(){return l}});var a=r(57437),s=r(2265),o=r(93448);let l=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("textarea",{className:(0,o.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});l.displayName="Textarea"},40477:function(e,t,r){"use strict";r.d(t,{G:function(){return l},a:function(){return n}});var a=r(57437),s=r(2265);let o=(0,s.createContext)(void 0),l=e=>{let{children:t}=e,[r,l]=(0,s.useState)([]);return(0,s.useEffect)(()=>{try{let e=localStorage.getItem("calm-nest-results");e&&l(JSON.parse(e))}catch(e){console.error("Failed to load results from localStorage",e)}},[]),(0,s.useEffect)(()=>{try{localStorage.setItem("calm-nest-results",JSON.stringify(r))}catch(e){console.error("Failed to save results to localStorage",e)}},[r]),(0,a.jsx)(o.Provider,{value:{results:r,addResult:e=>{l(t=>[...t,e])}},children:t})},n=()=>{let e=(0,s.useContext)(o);if(void 0===e)throw Error("useResults must be used within a ResultsProvider");return e}},58086:function(e,t,r){"use strict";r.d(t,{G:function(){return i},X:function(){return n}});var a=r(57437),s=r(2265),o=r(71774);let l=(0,s.createContext)(void 0);function n(e){var t;let{children:r}=e,[n,i]=(0,s.useState)(null),[d,c]=(0,s.useState)(!0),u=(0,o.useSession)();(0,o.useSupabaseClient)();let m=async()=>{var e,t,r;if(!(null==u?void 0:null===(e=u.user)||void 0===e?void 0:e.id)){i(null),c(!1);return}try{c(!0);let e=await fetch("http://127.0.0.1:5001/api/profile/".concat(u.user.id));if(e.ok){let t=await e.json(),r={id:u.user.id,email:u.user.email||"",full_name:t.full_name,age:t.age,gender:t.gender,updated_at:t.updated_at};i(r),localStorage.setItem("userProfile",JSON.stringify(r)),localStorage.setItem("userEmail",u.user.email||""),localStorage.setItem("userId",u.user.id),localStorage.setItem("userName",t.full_name||""),console.log("Profile fetched from Flask backend:",r)}else if(404===e.status){let e={id:u.user.id,email:u.user.email||"",full_name:(null===(t=u.user.user_metadata)||void 0===t?void 0:t.full_name)||""};i(e),localStorage.setItem("userProfile",JSON.stringify(e)),localStorage.setItem("userEmail",u.user.email||""),localStorage.setItem("userId",u.user.id),localStorage.setItem("userName",e.full_name||""),console.log("No profile found, created basic profile:",e)}else throw Error("Failed to fetch profile: ".concat(e.status))}catch(e){if(console.error("Error fetching profile:",e),null==u?void 0:u.user){let e={id:u.user.id,email:u.user.email||"",full_name:(null===(r=u.user.user_metadata)||void 0===r?void 0:r.full_name)||""};i(e),localStorage.setItem("userProfile",JSON.stringify(e)),localStorage.setItem("userEmail",u.user.email||""),localStorage.setItem("userId",u.user.id),localStorage.setItem("userName",e.full_name||""),console.log("Using fallback profile:",e)}}finally{c(!1)}},f=async e=>{var t;if(!(null==u?void 0:null===(t=u.user)||void 0===t?void 0:t.id)){console.error("No session or user ID available for profile update");return}console.log("UserProfileContext: Updating profile with data:",e),console.log("Current profile:",n);try{let t={id:u.user.id,email:u.user.email||"",full_name:e.full_name,age:e.age,gender:e.gender,updated_at:new Date().toISOString()};try{let r=await fetch("http://127.0.0.1:5001/api/profile/".concat(u.user.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:u.user.email,full_name:e.full_name,age:e.age,gender:e.gender})});if(r.ok){let e=await r.json();console.log("Profile updated successfully in Flask backend:",e);let a=e.profile;t.updated_at=a.updated_at}else console.log("Flask backend update failed, continuing with localStorage only")}catch(e){console.log("Flask backend operations failed, using localStorage only:",e)}console.log("Updating local profile state:",t),i(t),localStorage.setItem("userProfile",JSON.stringify(t)),localStorage.setItem("userName",t.full_name||""),localStorage.setItem("userEmail",t.email||""),localStorage.setItem("userId",t.id),console.log("Profile updated successfully in localStorage")}catch(e){throw console.error("Critical error updating profile:",e),e}},p=async()=>{await m()};return(0,s.useEffect)(()=>{var e;(null==u?void 0:null===(e=u.user)||void 0===e?void 0:e.id)?(console.log("UserProfileContext: Session detected, fetching profile for:",u.user.id),m()):(console.log("UserProfileContext: No session, clearing profile data"),i(null),c(!1),localStorage.removeItem("userProfile"),localStorage.removeItem("userName"),localStorage.removeItem("userEmail"),localStorage.removeItem("userId"))},[null==u?void 0:null===(t=u.user)||void 0===t?void 0:t.id]),(0,a.jsx)(l.Provider,{value:{profile:n,loading:d,updateProfile:f,refreshProfile:p},children:r})}function i(){let e=(0,s.useContext)(l);if(void 0===e)throw Error("useUserProfile must be used within a UserProfileProvider");return e}},88933:function(e,t,r){"use strict";r.d(t,{O:function(){return a}});let a=(0,r(71545).eI)("https://dummy-project.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR1bW15LXByb2plY3QiLCJyb2xlIjoiYW5vbiIsImlhdCI6MTY0NjA2NzI2MCwiZXhwIjoxOTYxNjQzMjYwfQ.dummy-key-for-development")},93448:function(e,t,r){"use strict";r.d(t,{cn:function(){return o}});var a=r(61994),s=r(53335);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,a.W)(t))}},2778:function(){}},function(e){e.O(0,[2002,5569,9452,7506,7648,4606,244,1545,6401,2247,25,2971,2117,1744],function(){return e(e.s=55760)}),_N_E=e.O()}]);