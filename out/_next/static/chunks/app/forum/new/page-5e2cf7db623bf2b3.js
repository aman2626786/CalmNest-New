(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4730],{95293:function(e,t,r){Promise.resolve().then(r.bind(r,43601))},71774:function(e,t,r){"use strict";var o=Object.defineProperty,s=Object.getOwnPropertyDescriptor,n=Object.getOwnPropertyNames,a=Object.prototype.hasOwnProperty,l=(e,t,r)=>new Promise((o,s)=>{var n=e=>{try{l(r.next(e))}catch(e){s(e)}},a=e=>{try{l(r.throw(e))}catch(e){s(e)}},l=e=>e.done?o(e.value):Promise.resolve(e.value).then(n,a);l((r=r.apply(e,t)).next())}),i={};((e,t)=>{for(var r in t)o(e,r,{get:t[r],enumerable:!0})})(i,{SessionContextProvider:()=>f,useSession:()=>p,useSessionContext:()=>m,useSupabaseClient:()=>g,useUser:()=>x}),e.exports=((e,t,r,l)=>{if(t&&"object"==typeof t||"function"==typeof t)for(let i of n(t))a.call(e,i)||i===r||o(e,i,{get:()=>t[i],enumerable:!(l=s(t,i))||l.enumerable});return e})(o({},"__esModule",{value:!0}),i);var u=r(2265),d=r(57437),c=(0,u.createContext)({isLoading:!0,session:null,error:null,supabaseClient:{}}),f=({supabaseClient:e,initialSession:t=null,children:r})=>{let[o,s]=(0,u.useState)(t),[n,a]=(0,u.useState)(!t),[i,f]=(0,u.useState)();(0,u.useEffect)(()=>{!o&&t&&s(t)},[o,t]),(0,u.useEffect)(()=>{let t=!0;return function(){l(this,null,function*(){let{data:{session:r},error:o}=yield e.auth.getSession();if(t){if(o){f(o),a(!1);return}s(r),a(!1)}})}(),()=>{t=!1}},[]),(0,u.useEffect)(()=>{let{data:{subscription:t}}=e.auth.onAuthStateChange((e,t)=>{t&&("SIGNED_IN"===e||"TOKEN_REFRESHED"===e||"USER_UPDATED"===e)&&s(t),"SIGNED_OUT"===e&&s(null)});return()=>{t.unsubscribe()}},[]);let m=(0,u.useMemo)(()=>n?{isLoading:!0,session:null,error:null,supabaseClient:e}:i?{isLoading:!1,session:null,error:i,supabaseClient:e}:{isLoading:!1,session:o,error:null,supabaseClient:e},[n,o,i]);return(0,d.jsx)(c.Provider,{value:m,children:r})},m=()=>{let e=(0,u.useContext)(c);if(void 0===e)throw Error("useSessionContext must be used within a SessionContextProvider.");return e};function g(){let e=(0,u.useContext)(c);if(void 0===e)throw Error("useSupabaseClient must be used within a SessionContextProvider.");return e.supabaseClient}var p=()=>{let e=(0,u.useContext)(c);if(void 0===e)throw Error("useSession must be used within a SessionContextProvider.");return e.session},x=()=>{var e,t;let r=(0,u.useContext)(c);if(void 0===r)throw Error("useUser must be used within a SessionContextProvider.");return null!=(t=null==(e=r.session)?void 0:e.user)?t:null}},51817:function(e,t,r){"use strict";r.d(t,{Z:function(){return o}});let o=(0,r(79205).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},43601:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return v}});var o=r(57437),s=r(45701),n=r(29501),a=r(67119),l=r(99376),i=r(58086),u=r(12381),d=r(80670),c=r(40279),f=r(23675),m=r(15291),g=r(95937);let p=(0,r(79205).Z)("terminal",[["path",{d:"M12 19h8",key:"baeox8"}],["path",{d:"m4 17 6-6-6-6",key:"1yngyt"}]]);var x=r(51817);let h=a.Ry({title:a.Z_().min(5,{message:"Title must be at least 5 characters."}).max(150),category:a.Z_({required_error:"Please select a category."}),content:a.Z_().min(20,{message:"Content must be at least 20 characters."}).max(5e3)});function v(){let e=(0,l.useRouter)(),{profile:t}=(0,i.G)(),r=(0,n.cI)({resolver:(0,s.F)(h),defaultValues:{title:"",content:""}});async function a(r){try{var o,s;let n=localStorage.getItem("userEmail")||(null==t?void 0:t.email)||"anonymous@example.com",a=localStorage.getItem("userId")||(null==t?void 0:t.id)||"anonymous-user",l=(null===(o=localStorage.getItem("userName"))||void 0===o?void 0:o.trim())||(null==t?void 0:null===(s=t.full_name)||void 0===s?void 0:s.trim())||n.split("@")[0]||"Anonymous";console.log("Submitting forum post:",{title:r.title,category:r.category,content:r.content,userId:a,userEmail:n,userName:l}),console.log("Profile data:",t);let i=await fetch("http://127.0.0.1:5001/api/forum",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify({userId:a,title:r.title,content:r.content,author:l,category:r.category})});if(console.log("Forum API response status:",i.status),i.ok){let t=await i.json();console.log("Forum post created successfully:",t),alert("Post created successfully!"),e.push("/forum")}else{let e=await i.text();console.error("Forum API error:",e),alert("Error: ".concat(e||"Failed to create post"))}}catch(e){console.error("Failed to submit forum post:",e),alert("Network error: ".concat(e instanceof Error?e.message:"An unexpected error occurred."))}}return(0,o.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-gray-900 via-purple-900/10 to-gray-900",children:(0,o.jsxs)("div",{className:"max-w-4xl mx-auto p-4 md:p-8 text-foreground",children:[(0,o.jsx)("h1",{className:"text-4xl font-bold mb-6 text-foreground",children:"Create a New Post"}),(0,o.jsxs)(g.bZ,{className:"mb-8 bg-card border-yellow-500/50",children:[(0,o.jsx)(p,{className:"h-4 w-4"}),(0,o.jsx)(g.Cd,{className:"text-yellow-400",children:"Community Guidelines"}),(0,o.jsx)(g.X,{className:"text-muted-foreground",children:"Be respectful and supportive. No personal attacks or harassment. Keep discussions focused on mental health and wellness. All posts are anonymous."})]}),(0,o.jsx)(d.l0,{...r,children:(0,o.jsxs)("form",{onSubmit:r.handleSubmit(a),className:"space-y-8",children:[(0,o.jsx)(d.Wi,{control:r.control,name:"title",render:e=>{let{field:t}=e;return(0,o.jsxs)(d.xJ,{children:[(0,o.jsx)(d.lX,{className:"text-lg text-foreground",children:"Title"}),(0,o.jsx)(d.NI,{children:(0,o.jsx)(c.I,{placeholder:"Enter a descriptive title for your post",...t,className:"bg-input border-border text-foreground"})}),(0,o.jsx)(d.zG,{})]})}}),(0,o.jsx)(d.Wi,{control:r.control,name:"category",render:e=>{let{field:t}=e;return(0,o.jsxs)(d.xJ,{children:[(0,o.jsx)(d.lX,{className:"text-lg text-foreground",children:"Category"}),(0,o.jsxs)(m.Ph,{onValueChange:t.onChange,defaultValue:t.value,children:[(0,o.jsx)(d.NI,{children:(0,o.jsx)(m.i4,{className:"bg-input border-border text-foreground",children:(0,o.jsx)(m.ki,{placeholder:"Select a category that best fits your post"})})}),(0,o.jsxs)(m.Bw,{className:"bg-popover border-border text-popover-foreground",children:[(0,o.jsx)(m.Ql,{value:"General",className:"text-foreground hover:bg-accent focus:bg-accent focus:text-accent-foreground",children:"General"}),(0,o.jsx)(m.Ql,{value:"Anxiety",className:"text-foreground hover:bg-accent focus:bg-accent focus:text-accent-foreground",children:"Anxiety"}),(0,o.jsx)(m.Ql,{value:"Depression",className:"text-foreground hover:bg-accent focus:bg-accent focus:text-accent-foreground",children:"Depression"}),(0,o.jsx)(m.Ql,{value:"Stress",className:"text-foreground hover:bg-accent focus:bg-accent focus:text-accent-foreground",children:"Stress"}),(0,o.jsx)(m.Ql,{value:"Relationships",className:"text-foreground hover:bg-accent focus:bg-accent focus:text-accent-foreground",children:"Relationships"})]})]}),(0,o.jsx)(d.zG,{})]})}}),(0,o.jsx)(d.Wi,{control:r.control,name:"content",render:e=>{let{field:t}=e;return(0,o.jsxs)(d.xJ,{children:[(0,o.jsx)(d.lX,{className:"text-lg text-foreground",children:"Your Message"}),(0,o.jsx)(d.NI,{children:(0,o.jsx)(f.g,{placeholder:"Share your thoughts, feelings, or questions. Remember to be kind and respectful.",className:"min-h-[200px] bg-input border-border text-foreground",...t})}),(0,o.jsx)(d.zG,{})]})}}),(0,o.jsxs)(u.z,{type:"submit",disabled:r.formState.isSubmitting,className:"bg-purple-600 hover:bg-purple-700",children:[r.formState.isSubmitting&&(0,o.jsx)(x.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Submit Anonymously"]})]})})]})})}},95937:function(e,t,r){"use strict";r.d(t,{Cd:function(){return u},X:function(){return d},bZ:function(){return i}});var o=r(57437),s=r(2265),n=r(90535),a=r(93448);let l=(0,n.j)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),i=s.forwardRef((e,t)=>{let{className:r,variant:s,...n}=e;return(0,o.jsx)("div",{ref:t,role:"alert",className:(0,a.cn)(l({variant:s}),r),...n})});i.displayName="Alert";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,o.jsx)("h5",{ref:t,className:(0,a.cn)("mb-1 font-medium leading-none tracking-tight",r),...s})});u.displayName="AlertTitle";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,o.jsx)("div",{ref:t,className:(0,a.cn)("text-sm [&_p]:leading-relaxed",r),...s})});d.displayName="AlertDescription"},12381:function(e,t,r){"use strict";r.d(t,{d:function(){return i},z:function(){return u}});var o=r(57437),s=r(2265),n=r(37053),a=r(90535),l=r(93448);let i=(0,a.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),u=s.forwardRef((e,t)=>{let{className:r,variant:s,size:a,asChild:u=!1,...d}=e,c=u?n.g7:"button";return(0,o.jsx)(c,{className:(0,l.cn)(i({variant:s,size:a,className:r})),ref:t,...d})});u.displayName="Button"},80670:function(e,t,r){"use strict";r.d(t,{NI:function(){return x},Wi:function(){return c},l0:function(){return u},lX:function(){return p},xJ:function(){return g},zG:function(){return h}});var o=r(57437),s=r(2265),n=r(37053),a=r(29501),l=r(93448),i=r(75060);let u=a.RV,d=s.createContext(null),c=e=>{let{...t}=e;return(0,o.jsx)(d.Provider,{value:{name:t.name},children:(0,o.jsx)(a.Qr,{...t})})},f=()=>{let e=s.useContext(d),t=s.useContext(m),{getFieldState:r,formState:o}=(0,a.Gc)();if(!e)throw Error("useFormField should be used within <FormField>");if(!t)throw Error("useFormField should be used within <FormItem>");let n=r(e.name,o),{id:l}=t;return{id:l,name:e.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...n}},m=s.createContext(null),g=s.forwardRef((e,t)=>{let{className:r,...n}=e,a=s.useId();return(0,o.jsx)(m.Provider,{value:{id:a},children:(0,o.jsx)("div",{ref:t,className:(0,l.cn)("space-y-2",r),...n})})});g.displayName="FormItem";let p=s.forwardRef((e,t)=>{let{className:r,...s}=e,{error:n,formItemId:a}=f();return(0,o.jsx)(i._,{ref:t,className:(0,l.cn)(n&&"text-destructive",r),htmlFor:a,...s})});p.displayName="FormLabel";let x=s.forwardRef((e,t)=>{let{...r}=e,{error:s,formItemId:a,formDescriptionId:l,formMessageId:i}=f();return(0,o.jsx)(n.g7,{ref:t,id:a,"aria-describedby":s?"".concat(l," ").concat(i):"".concat(l),"aria-invalid":!!s,...r})});x.displayName="FormControl",s.forwardRef((e,t)=>{let{className:r,...s}=e,{formDescriptionId:n}=f();return(0,o.jsx)("p",{ref:t,id:n,className:(0,l.cn)("text-[0.8rem] text-muted-foreground",r),...s})}).displayName="FormDescription";let h=s.forwardRef((e,t)=>{var r;let{className:s,children:n,...a}=e,{error:i,formMessageId:u}=f(),d=i?String(null!==(r=null==i?void 0:i.message)&&void 0!==r?r:""):n;return d?(0,o.jsx)("p",{ref:t,id:u,className:(0,l.cn)("text-[0.8rem] font-medium text-destructive",s),...a,children:d}):null});h.displayName="FormMessage"},40279:function(e,t,r){"use strict";r.d(t,{I:function(){return a}});var o=r(57437),s=r(2265),n=r(93448);let a=s.forwardRef((e,t)=>{let{className:r,type:s,...a}=e;return(0,o.jsx)("input",{type:s,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...a})});a.displayName="Input"},75060:function(e,t,r){"use strict";r.d(t,{_:function(){return u}});var o=r(57437),s=r(2265),n=r(6394),a=r(90535),l=r(93448);let i=(0,a.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,o.jsx)(n.f,{ref:t,className:(0,l.cn)(i(),r),...s})});u.displayName=n.f.displayName},15291:function(e,t,r){"use strict";r.d(t,{Bw:function(){return f},Ph:function(){return u},Ql:function(){return m},i4:function(){return c},ki:function(){return d}});var o=r(57437),s=r(2265),n=r(33911),a=r(40875),l=r(30401),i=r(93448);let u=n.fC;n.ZA;let d=n.B4,c=s.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,o.jsxs)(n.xz,{ref:t,className:(0,i.cn)("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),...l,children:[s,(0,o.jsx)(n.JO,{asChild:!0,children:(0,o.jsx)(a.Z,{className:"h-4 w-4 opacity-50"})})]})});c.displayName=n.xz.displayName;let f=s.forwardRef((e,t)=>{let{className:r,children:s,position:a="popper",...l}=e;return(0,o.jsx)(n.h_,{children:(0,o.jsx)(n.VY,{ref:t,className:(0,i.cn)("relative z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===a&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]",r),position:a,...l,children:(0,o.jsx)(n.l_,{className:(0,i.cn)("p-1",r),children:s})})})});f.displayName=n.VY.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,o.jsx)(n.__,{ref:t,className:(0,i.cn)("py-1.5 pl-2 pr-8 text-sm font-semibold",r),...s})}).displayName=n.__.displayName;let m=s.forwardRef((e,t)=>{let{className:r,children:s,...a}=e;return(0,o.jsxs)(n.ck,{ref:t,className:(0,i.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r),...a,children:[(0,o.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,o.jsx)(n.wU,{children:(0,o.jsx)(l.Z,{className:"h-4 w-4"})})}),(0,o.jsx)(n.eT,{children:s})]})});m.displayName=n.ck.displayName,s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,o.jsx)(n.Z0,{ref:t,className:(0,i.cn)("-mx-1 my-1 h-px bg-muted",r),...s})}).displayName=n.Z0.displayName},23675:function(e,t,r){"use strict";r.d(t,{g:function(){return a}});var o=r(57437),s=r(2265),n=r(93448);let a=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,o.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...s})});a.displayName="Textarea"},58086:function(e,t,r){"use strict";r.d(t,{G:function(){return i},X:function(){return l}});var o=r(57437),s=r(2265),n=r(71774);let a=(0,s.createContext)(void 0);function l(e){var t;let{children:r}=e,[l,i]=(0,s.useState)(null),[u,d]=(0,s.useState)(!0),c=(0,n.useSession)();(0,n.useSupabaseClient)();let f=async()=>{var e,t,r;if(!(null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.id)){i(null),d(!1);return}try{d(!0);let e=await fetch("http://127.0.0.1:5001/api/profile/".concat(c.user.id));if(e.ok){let t=await e.json(),r={id:c.user.id,email:c.user.email||"",full_name:t.full_name,age:t.age,gender:t.gender,updated_at:t.updated_at};i(r),localStorage.setItem("userProfile",JSON.stringify(r)),localStorage.setItem("userEmail",c.user.email||""),localStorage.setItem("userId",c.user.id),localStorage.setItem("userName",t.full_name||""),console.log("Profile fetched from Flask backend:",r)}else if(404===e.status){let e={id:c.user.id,email:c.user.email||"",full_name:(null===(t=c.user.user_metadata)||void 0===t?void 0:t.full_name)||""};i(e),localStorage.setItem("userProfile",JSON.stringify(e)),localStorage.setItem("userEmail",c.user.email||""),localStorage.setItem("userId",c.user.id),localStorage.setItem("userName",e.full_name||""),console.log("No profile found, created basic profile:",e)}else throw Error("Failed to fetch profile: ".concat(e.status))}catch(e){if(console.error("Error fetching profile:",e),null==c?void 0:c.user){let e={id:c.user.id,email:c.user.email||"",full_name:(null===(r=c.user.user_metadata)||void 0===r?void 0:r.full_name)||""};i(e),localStorage.setItem("userProfile",JSON.stringify(e)),localStorage.setItem("userEmail",c.user.email||""),localStorage.setItem("userId",c.user.id),localStorage.setItem("userName",e.full_name||""),console.log("Using fallback profile:",e)}}finally{d(!1)}},m=async e=>{var t;if(!(null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.id)){console.error("No session or user ID available for profile update");return}console.log("UserProfileContext: Updating profile with data:",e),console.log("Current profile:",l);try{let t={id:c.user.id,email:c.user.email||"",full_name:e.full_name,age:e.age,gender:e.gender,updated_at:new Date().toISOString()};try{let r=await fetch("http://127.0.0.1:5001/api/profile/".concat(c.user.id),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:c.user.email,full_name:e.full_name,age:e.age,gender:e.gender})});if(r.ok){let e=await r.json();console.log("Profile updated successfully in Flask backend:",e);let o=e.profile;t.updated_at=o.updated_at}else console.log("Flask backend update failed, continuing with localStorage only")}catch(e){console.log("Flask backend operations failed, using localStorage only:",e)}console.log("Updating local profile state:",t),i(t),localStorage.setItem("userProfile",JSON.stringify(t)),localStorage.setItem("userName",t.full_name||""),localStorage.setItem("userEmail",t.email||""),localStorage.setItem("userId",t.id),console.log("Profile updated successfully in localStorage")}catch(e){throw console.error("Critical error updating profile:",e),e}},g=async()=>{await f()};return(0,s.useEffect)(()=>{var e;(null==c?void 0:null===(e=c.user)||void 0===e?void 0:e.id)?(console.log("UserProfileContext: Session detected, fetching profile for:",c.user.id),f()):(console.log("UserProfileContext: No session, clearing profile data"),i(null),d(!1),localStorage.removeItem("userProfile"),localStorage.removeItem("userName"),localStorage.removeItem("userEmail"),localStorage.removeItem("userId"))},[null==c?void 0:null===(t=c.user)||void 0===t?void 0:t.id]),(0,o.jsx)(a.Provider,{value:{profile:l,loading:u,updateProfile:m,refreshProfile:g},children:r})}function i(){let e=(0,s.useContext)(a);if(void 0===e)throw Error("useUserProfile must be used within a UserProfileProvider");return e}},93448:function(e,t,r){"use strict";r.d(t,{cn:function(){return n}});var o=r(61994),s=r(53335);function n(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.m6)((0,o.W)(t))}}},function(e){e.O(0,[5569,9452,4606,6401,5974,2971,2117,1744],function(){return e(e.s=95293)}),_N_E=e.O()}]);